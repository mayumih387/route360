import React, { useState, useContext } from "react"
import { Link } from "gatsby"
import ThemeContext from "../context/ThemeContext"

import { langName } from "../../data/i18n"
import * as classes from "../styles/header.module.css"

const Header = ({
  currentLang = "en",
  availLangs = ["en", "fr", "ja"],
  pagePath = "",
  pageLayout = "post",
}) => {
  const ctx = useContext(ThemeContext)

  const [showLangSelector, setShowLangSelector] = useState(false)

  const clickHandler = () => {
    setShowLangSelector(prevState => !prevState)
  }

  return (
    <header>
      <div className={classes.headerContainer}>
        {pageLayout === "post" && (
          <Link to={`/${currentLang}/`} className={classes.logoLink}>
            <span className="sr-only">Route360</span>
            <svg viewBox="0 0 109.6 18.9" xmlns="http://www.w3.org/2000/svg">
              <g>
                <path
                  d="M8.9 108.7V93.2h6.9q1 0 2 .4.8.4 1.5 1.2.7.7 1 1.6.4 1 .4 2t-.3 1.8q-.4 1-1 1.6-.6.7-1.5 1l3.5 5.9h-3.3l-3.2-5.2h-3v5.2zm3-7.9h3.8q.6 0 1-.3t.7-.9q.3-.6.3-1.3 0-.7-.3-1.3l-.8-.9q-.5-.3-1-.3h-3.7zM29.6 109q-1.4 0-2.5-.5-1-.5-1.9-1.4-.7-.8-1.2-1.9-.4-1-.4-2.2 0-1.2.4-2.3.5-1 1.2-1.9.8-.8 2-1.3 1-.5 2.4-.5t2.5.5q1.1.5 2 1.3.7.8 1.1 2 .4 1 .4 2.2 0 1.2-.4 2.2-.4 1.1-1.2 2-.7.8-1.8 1.3-1.2.4-2.6.4zm-3-6q0 1 .4 1.8.4.7 1.1 1.2.7.4 1.5.4.9 0 1.5-.4.7-.5 1.1-1.2.4-.8.4-1.8t-.4-1.8q-.4-.8-1-1.2-.7-.5-1.6-.5-.8 0-1.5.5-.7.4-1 1.2-.5.8-.5 1.8zM39 104.4v-7.2h3v6.6q0 1.3.5 2 .5.6 1.4.6.6 0 1.1-.2.6-.2 1-.7l.9-1.2v-7h2.9v8.1q0 .5.2.7.1.2.5.2v2.4h-.7l-.6.1q-.8 0-1.3-.3-.4-.4-.5-1l-.1-1q-.8 1.2-2 1.8-1.2.6-2.6.6-1.8 0-2.7-1.1-1-1.2-1-3.4zM61.1 108.1l-.9.4-1.1.3h-1.2q-.8 0-1.5-.2-.7-.3-1.1-.9-.4-.6-.4-1.6v-6.6h-1.5v-2.3h1.5v-3.7h3v3.7h2.3v2.3h-2.4v5.6q0 .6.4.8.3.3.7.3l1-.2.6-.2zM69.4 109q-1.4 0-2.5-.5t-1.9-1.3q-.8-.9-1.2-2-.4-1-.4-2.2 0-1.6.7-3 .7-1.3 2.1-2.1 1.4-.9 3.2-.9 2 0 3.2.9 1.4.8 2 2.1.8 1.4.8 3v.9h-9q.2.9.6 1.5.4.7 1 1 .8.4 1.5.4.9 0 1.7-.4.7-.5 1-1.2l2.5.7q-.4.9-1.2 1.6-.7.6-1.8 1-1 .4-2.3.4zm-3-7h6q0-.8-.5-1.5-.4-.6-1-1-.7-.3-1.5-.3t-1.5.3q-.6.4-1 1-.4.7-.5 1.5zM85.8 103.5q.9.2 1.6.7.7.6 1 1.4.4.8.4 1.8 0 1.4-.7 2.4t-2 1.5q-1.2.6-3 .6-1.6 0-3-.5-1.2-.6-2-1.6l1.6-2q.6.6 1.4 1 .8.4 2 .4 1.3 0 2-.5t.7-1.6q0-1.1-.8-1.8-.8-.6-2.5-.6H82v-2.2h.7q1.3 0 2-.6.8-.6.8-1.5 0-.6-.2-1-.3-.4-.8-.6-.5-.2-1.2-.2-1 0-1.8.5t-1.3 1.3l-1.8-2q.4-.7 1.2-1.2.8-.5 1.9-.8 1-.3 2.2-.3 1.4 0 2.6.5 1 .5 1.7 1.3.7 1 .7 2t-.4 1.7q-.3.8-1 1.3-.6.5-1.4.6zM103.6 103.5q0-1.5-.7-2.6-.7-1.2-1.9-1.9t-2.8-.7q-.7 0-1.3.2-.7.2-1.1.6-.5.4-.8 1 0-1.5.4-2.4.4-1 1.1-1.6.7-.5 1.7-.5t1.8.5q.8.4 1.4 1.2l1.7-1.8q-.9-1.2-2.1-1.8-1.3-.6-2.7-.6-1.9 0-3.2 1-1.4 1-2.1 3-.7 1.9-.7 4.7 0 2.2.7 3.8.7 1.6 2 2.5 1.2.8 3 .8 1.6 0 2.8-.7 1.3-.7 2-2 .8-1.2.8-2.7zm-5.6 3q-.8 0-1.4-.5-.7-.4-1-1-.5-.7-.5-1.5t.4-1.4q.4-.7 1-1 .7-.4 1.5-.4t1.4.4q.7.3 1 1 .4.6.4 1.4 0 .8-.3 1.5-.4.6-1.1 1-.7.4-1.4.4zM118.5 102.3q0 2-.8 3.4-.7 1.5-2 2.4-1.3.8-2.9.8-1.6 0-2.9-.8-1.3-.9-2-2.4t-.7-3.4q0-2 .7-3.4.7-1.5 2-2.4 1.3-.9 3-.9 1.5 0 2.8 1 1.3.8 2 2.3.8 1.5.8 3.4zm-3 0q0-1.2-.3-2-.4-1-1-1.5t-1.4-.5q-.8 0-1.4.5-.6.5-1 1.4-.3 1-.3 2 0 1.3.3 2.1.4 1 1 1.4.6.5 1.4.5.8 0 1.4-.5.6-.5 1-1.4.3-.9.3-2z"
                  transform="translate(-8.9 -93)"
                />
              </g>
            </svg>
          </Link>
        )}
        {pageLayout === "archive" && (
          <h1>
            <Link to={`/${currentLang}/`} className={classes.logoLink}>
              <span className="sr-only">Route360</span>
              <svg viewBox="0 0 109.6 18.9" xmlns="http://www.w3.org/2000/svg">
                <g>
                  <path
                    d="M8.9 108.7V93.2h6.9q1 0 2 .4.8.4 1.5 1.2.7.7 1 1.6.4 1 .4 2t-.3 1.8q-.4 1-1 1.6-.6.7-1.5 1l3.5 5.9h-3.3l-3.2-5.2h-3v5.2zm3-7.9h3.8q.6 0 1-.3t.7-.9q.3-.6.3-1.3 0-.7-.3-1.3l-.8-.9q-.5-.3-1-.3h-3.7zM29.6 109q-1.4 0-2.5-.5-1-.5-1.9-1.4-.7-.8-1.2-1.9-.4-1-.4-2.2 0-1.2.4-2.3.5-1 1.2-1.9.8-.8 2-1.3 1-.5 2.4-.5t2.5.5q1.1.5 2 1.3.7.8 1.1 2 .4 1 .4 2.2 0 1.2-.4 2.2-.4 1.1-1.2 2-.7.8-1.8 1.3-1.2.4-2.6.4zm-3-6q0 1 .4 1.8.4.7 1.1 1.2.7.4 1.5.4.9 0 1.5-.4.7-.5 1.1-1.2.4-.8.4-1.8t-.4-1.8q-.4-.8-1-1.2-.7-.5-1.6-.5-.8 0-1.5.5-.7.4-1 1.2-.5.8-.5 1.8zM39 104.4v-7.2h3v6.6q0 1.3.5 2 .5.6 1.4.6.6 0 1.1-.2.6-.2 1-.7l.9-1.2v-7h2.9v8.1q0 .5.2.7.1.2.5.2v2.4h-.7l-.6.1q-.8 0-1.3-.3-.4-.4-.5-1l-.1-1q-.8 1.2-2 1.8-1.2.6-2.6.6-1.8 0-2.7-1.1-1-1.2-1-3.4zM61.1 108.1l-.9.4-1.1.3h-1.2q-.8 0-1.5-.2-.7-.3-1.1-.9-.4-.6-.4-1.6v-6.6h-1.5v-2.3h1.5v-3.7h3v3.7h2.3v2.3h-2.4v5.6q0 .6.4.8.3.3.7.3l1-.2.6-.2zM69.4 109q-1.4 0-2.5-.5t-1.9-1.3q-.8-.9-1.2-2-.4-1-.4-2.2 0-1.6.7-3 .7-1.3 2.1-2.1 1.4-.9 3.2-.9 2 0 3.2.9 1.4.8 2 2.1.8 1.4.8 3v.9h-9q.2.9.6 1.5.4.7 1 1 .8.4 1.5.4.9 0 1.7-.4.7-.5 1-1.2l2.5.7q-.4.9-1.2 1.6-.7.6-1.8 1-1 .4-2.3.4zm-3-7h6q0-.8-.5-1.5-.4-.6-1-1-.7-.3-1.5-.3t-1.5.3q-.6.4-1 1-.4.7-.5 1.5zM85.8 103.5q.9.2 1.6.7.7.6 1 1.4.4.8.4 1.8 0 1.4-.7 2.4t-2 1.5q-1.2.6-3 .6-1.6 0-3-.5-1.2-.6-2-1.6l1.6-2q.6.6 1.4 1 .8.4 2 .4 1.3 0 2-.5t.7-1.6q0-1.1-.8-1.8-.8-.6-2.5-.6H82v-2.2h.7q1.3 0 2-.6.8-.6.8-1.5 0-.6-.2-1-.3-.4-.8-.6-.5-.2-1.2-.2-1 0-1.8.5t-1.3 1.3l-1.8-2q.4-.7 1.2-1.2.8-.5 1.9-.8 1-.3 2.2-.3 1.4 0 2.6.5 1 .5 1.7 1.3.7 1 .7 2t-.4 1.7q-.3.8-1 1.3-.6.5-1.4.6zM103.6 103.5q0-1.5-.7-2.6-.7-1.2-1.9-1.9t-2.8-.7q-.7 0-1.3.2-.7.2-1.1.6-.5.4-.8 1 0-1.5.4-2.4.4-1 1.1-1.6.7-.5 1.7-.5t1.8.5q.8.4 1.4 1.2l1.7-1.8q-.9-1.2-2.1-1.8-1.3-.6-2.7-.6-1.9 0-3.2 1-1.4 1-2.1 3-.7 1.9-.7 4.7 0 2.2.7 3.8.7 1.6 2 2.5 1.2.8 3 .8 1.6 0 2.8-.7 1.3-.7 2-2 .8-1.2.8-2.7zm-5.6 3q-.8 0-1.4-.5-.7-.4-1-1-.5-.7-.5-1.5t.4-1.4q.4-.7 1-1 .7-.4 1.5-.4t1.4.4q.7.3 1 1 .4.6.4 1.4 0 .8-.3 1.5-.4.6-1.1 1-.7.4-1.4.4zM118.5 102.3q0 2-.8 3.4-.7 1.5-2 2.4-1.3.8-2.9.8-1.6 0-2.9-.8-1.3-.9-2-2.4t-.7-3.4q0-2 .7-3.4.7-1.5 2-2.4 1.3-.9 3-.9 1.5 0 2.8 1 1.3.8 2 2.3.8 1.5.8 3.4zm-3 0q0-1.2-.3-2-.4-1-1-1.5t-1.4-.5q-.8 0-1.4.5-.6.5-1 1.4-.3 1-.3 2 0 1.3.3 2.1.4 1 1 1.4.6.5 1.4.5.8 0 1.4-.5.6-.5 1-1.4.3-.9.3-2z"
                    transform="translate(-8.9 -93)"
                  />
                </g>
              </svg>
            </Link>
          </h1>
        )}
        <nav className={classes.nav}>
          <button
            type="button"
            onClick={ctx.toggleDark}
            className={classes.themeBtn}
            aria-label="Theme Switcher"
          >
            {ctx.isDarkMode ? (
              <svg
                viewBox="0 0 24 24"
                fill="var(--primary-font-color)"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M19.6 14.6A8 8 0 0 1 9.4 4.4a8 8 0 1 0 10.2 10.2Z"
                  stroke="#000"
                  strokeWidth="2"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            ) : (
              <svg
                viewBox="0 0 24 24"
                fill="var(--primary-font-color)"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M5 12H3m9-7V3m9 9h-2m-7 9v-2m5-2 1.4 1.4M5.6 5.6l1.5 1.5m9.8 0 1.5-1.5M5.6 18.4l1.5-1.5M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
                  stroke="#000"
                  strokeWidth="2"
                  strokeLinecap="round"
                  strokeLinejoin="round"
                />
              </svg>
            )}
          </button>
          <button
            className={classes.langBtn}
            onClick={clickHandler}
            type="button"
          >
            <svg
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 21a9 9 0 1 0 0-18m0 18a9 9 0 1 1 0-18m0 18a13 13 0 0 1-4-9 13 13 0 0 1 4-9m0 18a13 13 0 0 0 4-9 13 13 0 0 0-4-9m8 6H4m16 6H4"
                stroke="var(--primary-font-color)"
                strokeWidth="2"
                strokeLinecap="round"
                strokeLinejoin="round"
              />
            </svg>
            <span className={classes.langName}>{langName[currentLang]}</span>
            {showLangSelector && (
              <ul className={classes.langSelecter}>
                {availLangs.map(lang => (
                  <li key={lang}>
                    <Link
                      to={`/${lang}/${pagePath}`}
                      rel="alternate"
                      hrefLang={lang}
                      className={
                        lang === currentLang ? classes.yellow : classes.normal
                      }
                    >
                      {langName[lang]}
                    </Link>
                  </li>
                ))}
              </ul>
            )}
          </button>
        </nav>
      </div>
    </header>
  )
}

export default Header
