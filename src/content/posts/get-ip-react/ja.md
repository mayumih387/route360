---
title: Reactã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ï¼ˆAxiosãªã—ï¼‰
tags:
  - react
date: 2022-11-24T02:00:00.185Z
lastmod: 2023-03-02T07:16:14.505Z
draft: false
---

å•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ ã‚„ã‚³ãƒ¡ãƒ³ãƒˆæ¬„ã®ã„ãŸãšã‚‰é˜²æ­¢ç”¨ã¨ã—ã¦IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã£ãŸãŸã‚ã«ã€å®Ÿæ–½ã—ãŸæ–¹æ³•ã§ã™ã€‚

Javascriptã¯å˜ä½“ã§ã¯é–²è¦§è€…ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã§ããªã„ãŸã‚ã€å¤–éƒ¨APIã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

ä»Šå›åˆ©ç”¨ã™ã‚‹React Hookã¯`useState()`ã¨`useEffect()`ã§ã™ã€‚

- [ãƒ‡ãƒ¢](https://starlit-lollipop-635291.netlify.app/demo/getip-demo)
- [ã‚³ãƒ¼ãƒ‰ï¼ˆGitHubï¼‰](https://github.com/mayumih387/demo-nextjs/blob/main/pages/demo/getip-demo.js)

ãƒ‡ãƒ¢ã¯Next.jsä¸Šã«ä½œã£ã¦ã„ã¾ã™ãŒã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã‚ãªã„Reactã‚¢ãƒ—ãƒªã§ã‚‚å•é¡Œãªã„ã¯ãšã§ã™ã€‚

## ä»Šå›åˆ©ç”¨ã™ã‚‹API

https://ipapi.co/

- ä¼šå“¡ç™»éŒ²ä¸è¦
- Adblockã«ã‚ˆã‚‹ãƒ–ãƒ­ãƒƒã‚¯ãªã—ï¼ˆè¨˜äº‹æŠ•ç¨¿æ™‚ç‚¹ã§ã¯ï¼‰

[ipinfo.io](https://ipinfo.io/)ã‚‚è©¦ã—ã¦ã¿ã¾ã—ãŸãŒã€AdblockãŒã‚ã‚‹ã¨ä¸Šæ‰‹ãå‹•ãã¾ã›ã‚“ã§ã—ãŸã€‚ç™»éŒ²ãŒå¿…è¦ãªåˆ†ã€æ©Ÿèƒ½ã¯å¤šã„ã§ã™ã€‚ã¾ãŸã€ipinfo.ioã¯é€€ä¼šã®éš›ã«ã‚µãƒãƒ¼ãƒˆã«ã‚ã–ã‚ã–ãƒ¡ãƒ¼ãƒ«ã§é€£çµ¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã®ã§ã€ã€Œã¡ã‚‡ã£ã¨è©¦ã—ãŸã„ã ã‘ã€ã«ã¯å°‘ã€…é¢å€’ã§ã™ã€‚

ä»–ã«ã‚‚ã„ãã¤ã‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—å‡ºæ¥ã‚‹ç„¡æ–™ã®APIã‚µãƒ¼ãƒ“ã‚¹ã¯ã‚ã‚Šã¾ã™ã€‚åŸºæœ¬çš„ã«ã‚³ãƒ¼ãƒ‰ã¯åŒã˜ï¼ˆå¤šå°‘ã€IPå–å¾—ã®ãŸã‚ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä»£ã‚ã‚‹ï¼‰ãªã®ã§ã€ã‚¢ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚

ç§ã®ã‚ªã‚¹ã‚¹ãƒ¡ã¯[Abstract API](https://www.abstractapi.com/)ã«ã‚ˆã‚‹ã€ŒIP Geolocation APIã€ã§ã™ã€‚åˆ©ç”¨ã«ç™»éŒ²ãŒå¿…è¦ã§ã€æœˆ20,000ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§ãŒç„¡æ–™ã§ã™ã€‚Adblockã«ã‚ˆã‚‹ä¸å…·åˆã‚‚ãªãã€ä»¥ä¸‹ã«è¿½è¨˜ã—ãŸipapi.coã‚ˆã†ãªIPv6ã§ã®è¿”ç­”ã‚‚ï¼ˆæã‚‰ãï¼‰ã‚ã‚Šã¾ã›ã‚“ã€‚

### ipapi.coã®æ³¨æ„ç‚¹ï¼ˆ2023.1.12è¿½è¨˜ï¼‰

ã‚¢ã‚¯ã‚»ã‚¹å…ƒã«ã‚ˆã‚Šã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒIPv6å½¢å¼ã§è¿”ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

ä¾‹: "240d:1a:b21:8500:9809:92e9:d811:7033A"

IPv4å½¢å¼ã®ã¿ã§åˆ©ç”¨ã—ãŸã„å ´åˆã¯ã€ipapi.coã§ã¯æœ‰æ–™ãƒ—ãƒ©ãƒ³ã®åˆ©ç”¨ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

## ã‚³ãƒ¼ãƒ‰

```js
import { useState, useEffect } from 'react'

export default function GetIP() {
  // åˆæœŸçŠ¶æ…‹ã¯ç©ºã®å®šæ•°`ip`ã‚’ç”¨æ„
  const [ip, setIp] = useState()

  const getIp = async () => {
    // fetchã‚’ä½¿ã£ã¦ipapi.coã«æ¥ç¶š
    const response = await fetch('https://ipapi.co/json/')
    const data = await response.json()
    // å–å¾—ã—ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€å®šæ•°`ip`ã«ã‚»ãƒƒãƒˆ
    setIp(data.ip)
  }

  // é–¢æ•°`getIP`ã‚’åˆå›ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ã®ã¿ç™ºå‹•ã•ã›ã‚‹
  useEffect(() => {
    getIp()
  }, [])

  return (
    <p>ã‚ãªãŸã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯{ip}ã§ã™ã€‚</p>
  )
}
```

1. åˆæœŸçŠ¶æ…‹ã¯ç©ºã®å®šæ•°`ip`ã‚’ç”¨æ„ã™ã‚‹
2. é–¢æ•°`getIP`ã®ä¸­ã§ã€fetchã‚’ä½¿ã£ã¦[ipapi.co](https://ipapi.co/)ã«æ¥ç¶šã€‚å–å¾—ã—ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã€`ip`ã«ã‚»ãƒƒãƒˆ
3. `useEffect()`ã‚’ä½¿ã„ã€é–¢æ•°`getIP`ã‚’åˆå›ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã§ç™ºå‹•ã•ã›ã‚‹

`const data = await response.json()`ã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã®ã§ã€ã“ã®ç›´ä¸‹ã§`console.log(data)`ã‚’èµ°ã‚‰ã›ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã®ãŒç¢ºèªã§ãã¾ã™ã€‚

```js
{
  "ip": "185.94.188.134",
  "network": "185.94.188.0/24",
  "version": "IPv4",
  "city": "Amsterdam",
  "region": "North Holland",
  "region_code": "NH",
  "country": "NL",
  "country_name": "Netherlands",
  "country_code": "NL",
  "country_code_iso3": "NLD",
  "country_capital": "Amsterdam",
  "country_tld": ".nl",
  "continent_code": "EU",
  "in_eu": true,
  "postal": "1012",
  "latitude": 52.3716,
  "longitude": 4.8883,
  "timezone": "Europe/Amsterdam",
  "utc_offset": "+0200",
  "country_calling_code": "+31",
  "currency": "EUR",
  "currency_name": "Euro",
  "languages": "nl-NL,fy-NL",
  "country_area": 41526,
  "country_population": 17231017,
  "asn": "AS9009",
  "org": "M247 Ltd"
}
```

IPã‚¢ãƒ‰ãƒ¬ã‚¹ã ã‘ã§ãªãã€å›½åã‚„çµŒåº¦ç·¯åº¦ã€ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚„ã€æ›´ã«ã¯ãƒ¦ãƒ¼ãƒ­åœã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚‚å–å¾—å‡ºæ¥ã‚‹ã®ã§ã€æ§˜ã€…ãªç”¨é€”ã«ä½¿ãˆãã†ã§ã™ã€‚

ã“ã®ã‚ãŸã‚Šã¯Reactã®åŸºç¤ã®éƒ¨åˆ†ãªã®ã§ã€ã‚ˆã„ç·´ç¿’ã«ãªã‚Šã¾ã™ã€‚ã¨ã¯è¨€ãˆã€ã“ã“ã«æ¥ãŸæ–¹ã€…ã¯ã‚³ãƒ”ãƒšã§çµ‚ã‚ã‚Šã§ã—ã‚‡ã†ã­ğŸ˜‚